{"version":3,"sources":["../../../units/rb-base-server/ensureFileContent.js"],"names":["fs","fsWithCallbacks","promises","ensureFileContent","fileName","currentFileContent","newFileContent","logToConsole","readFile","toString","err","code","console","log","chalk","white","bgGreen","writeFile","bgBlackBright"],"mappings":";;AAEA;;AAEA,sD;;AAEA,MAAMA,EAAE,GAAGC,YAAgBC,QAA3B,C;;AAEgCC,iB,GAAf,eAAeA,iBAAf;AACfC,QADe;AAEfC,kBAFe;AAGfC,cAHe;AAIfC,YAJe;AAKf;AACA;AACA,MAAKF,kBAAkB,IAAI,IAA3B,EAAkC;AAChC,QAAI;AACFA,MAAAA,kBAAkB,GAAG,CAAE,MAAML,EAAE,CAACQ,QAAH,CAAaJ,QAAb,CAAR,EAAkCK,QAAlC,EAArB;AACD,KAFD,CAEE,OAAQC,GAAR,EAAc;AACd,UAAKA,GAAG,CAACC,IAAJ,KAAa,QAAlB,EAA6B,MAAMD,GAAN;AAC9B;AACF;;AAED,MAAKL,kBAAkB,KAAKC,cAA5B,EAA6C;AAC3C,QAAKC,YAAL,EAAoBK,OAAO,CAACC,GAAR,CAAaC,eAAMC,KAAN,CAAYC,OAAZ,CAAqB,WAArB,IAAqC,GAArC,GAA2CZ,QAAxD;AACpB,UAAMJ,EAAE,CAACiB,SAAH,CAAcb,QAAd,EAAwBE,cAAxB,EAAwC,MAAxC,CAAN;AACD,GAHD,MAGO;AACL,QAAKC,YAAL,EAAoBK,OAAO,CAACC,GAAR,CAAaC,eAAMC,KAAN,CAAYG,aAAZ,CAA2B,WAA3B,IAA2C,GAA3C,GAAiDd,QAA9D;AACrB;AACF,C","sourcesContent":["// @flow\n\nimport fsWithCallbacks from 'fs'\n\nimport chalk from 'chalk'\n\nconst fs = fsWithCallbacks.promises\n\nexport default ( async function ensureFileContent(\n  fileName: string,\n  currentFileContent: ?string,\n  newFileContent: string,\n  logToConsole: boolean,\n) {\n  // If the current file content is not provided, get it\n  if ( currentFileContent == null ) {\n    try {\n      currentFileContent = ( await fs.readFile( fileName ) ).toString()\n    } catch ( err ) {\n      if ( err.code !== 'ENOENT' ) throw err\n    }\n  }\n\n  if ( currentFileContent !== newFileContent ) {\n    if ( logToConsole ) console.log( chalk.white.bgGreen( '[written]' ) + ' ' + fileName )\n    await fs.writeFile( fileName, newFileContent, 'utf8' )\n  } else {\n    if ( logToConsole ) console.log( chalk.white.bgBlackBright( '[skipped]' ) + ' ' + fileName )\n  }\n})\n"],"file":"ensureFileContent.js"}